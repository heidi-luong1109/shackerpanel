var bt_tools={table:function(e){function t(e){this.config=e,this.$load()}return t.prototype={style_list:[],event_list:{},checkbox_list:[],batch_active:{},event_rows_model:{},data:[],page:"",column:[],batch_thread:[],random:bt.get_random(5),init:!1,checked:!1,$load:function(){var e=this,t=$('<input type="checkbox" id="checked_'+e.random+'" style="font-size:0;position:fixed;left:-9999999px;"/>');this.config.init&&this.config.init(this),$(this.config.el).addClass("bt_table").append(t),t.focus(function(){return e.checked=!0,!1}).blur(function(t){e.checked=!1,e.checked_blur&&e.checked_blur(t)}),this.config.minWidth&&this.style_list.push({className:this.config.el+" table",css:"min-width:"+this.config.minWidth}),this.config.tootls?this.$reader_tootls(this.config.tootls):0===$(e.config.el+".divtable").length&&$(e.config.el).append('<div class="divtable mtb10"></div>'),this.$reader_content(),void 0!==e.config.url?this.$refresh_table_list():void 0!==this.config.data?this.$reader_content(this.config.data):alert(lan.public.miss_data_or_url),this.config.methods&&$.extend(this,this.config.methods)},$refresh_table_list:function(e){var t,i=this;e&&(t=bt.load(lan.database.get_data)),this.$http(function(a,s){e&&t.close(),i.$reader_content(a,s)})},$active_focus:function(e){var t=this;$("#checked_"+t.random).focus(),this.checked_blur=function(i){setTimeout(function(){e&&e(i),delete t.checked_blur},200)}},$reader_content:function(e,t){var i=this,a="",s="",n=0,l=this.config.column,c={},o=$(i.config.el+" .checkbox_"+i.random);e=e||[],this.data=e,o.length&&(o.removeClass("active selected"),i.checkbox_list=[],i.$set_batch_view());do{var r=e[n],d=0;e.length>0&&(s+="<tr>");for(var p=0;p<l.length;p++){var _=l[p];if($.isEmptyObject(_))d++;else{if(0===n&&!this.init){this.init||this.style_list.push(this.$dynamic_merge_style(_,p-d));var h="sort_"+this.random,f="checkbox_"+this.random,u=_.sortValue||"desc";a+="<th><span "+(_.sort?'class="not-select '+h+(_.sortValue?" sort-active":"")+' cursor-pointer"':"")+' data-index="'+p+'" '+(_.sort?'data-sort="'+u+'"':"")+">"+("checkbox"==_.type?'<label><i class="cust—checkbox cursor-pointer '+f+'" data-checkbox="all"></i><input type="checkbox" class="cust—checkbox-input"></label>':"<span>"+_.title+"</span>")+(_.sort?'<span class="glyphicon glyphicon-triangle-'+("desc"==u?"bottom":"top")+' ml5"></span>':"")+"</span></th>",0===n&&(!c[h]&&_.sort&&(c[h]={event:this.config.sortEvent,eventType:"click",type:"sort"}),c[f]||(c[f]={event:_.checked,eventType:"click",type:"checkbox"}))}if(void 0!==r){var v="",b="event-"+_.fid+"-"+this.random;_.template?v=i.$custom_template_render(_,r,p):(v=this.$reader_column_type(_,r),c=$.extend(c,v[1]),v=v[0]),s+="<td><span "+(_.class?'class="'+_.class+'"':"")+" "+(_.tips?'title="'+_.tips+'"':"")+">"+v+"</span></td>",0===n&&!c[b]&&_.event&&(c[b]={event:_.event,eventType:"click",type:"rows"})}}}e.length>0&&(s+="</tr>"),0==e.length&&(s+='<tr><td colspan="'+(l.length-d)+'" style="text-align:center;">'+(this.config.default||lan.public.empty)+"</td></tr>"),n++}while(n<e.length);this.init||this.$style_bind(this.style_list),this.$event_bind(c),this.init?($(this.config.el+" .divtable tbody").html(s),this.config.page&&t&&$(this.config.el+" .page").replaceWith(this.$reader_page(this.config.page,t))):$(this.config.el+" .divtable").append('<table class="table table-hover"><thead>'+a+"</thead><tbody>"+s+"</tbody></table></div></div>"),this.init=!0,this.config.success&&this.config.success(this)},$custom_template_render:function(e,t,i){var a="event-"+e.fid+"-"+this.random,s=e.template(t,i),n=$(s);return n.length>0?template=n.addClass(a)[0].outerHTML:"text"===e.type?template='<span class="'+a+'">'+s+"</span>":template='<a href="javascript:;" class="btlink '+a+'">'+s+"</a>",template},$modify_row_data:function(e){this.event_rows_model.rows=$.extend(this.event_rows_model.rows,e);var t=this.event_rows_model,i=null;i=void 0!==t.model.template?$(this.$custom_template_render(t.model,t.rows,t.index)):$(this.$reader_column_type(t.model,t.rows)[0]),t.el.replaceWith(i),t.el=i},$batch_success_table:function(e){var t=this;bt.open({type:1,title:e.title,area:e.area||["380px","350px"],shadeClose:!1,closeBtn:2,content:e.content||'<div class="batch_title"><span class><span class="batch_icon"></span><span class="batch_text">'+e.title+" "+lan.public.success+'</span></span></div><div class="fiexd_thead divtable success-layer" style="margin: 15px 30px 15px 30px;overflow: auto;height: 200px;"><table class="table table-hover"><thead><tr><th>'+e.th+'</th><th style="text-align:right;width:120px;">'+lan.public.result+"</th></tr></thead><tbody>"+e.html+"</tbody></table></div>",success:function(){t.$fixed_table_thead(".fiexd_thead")}})},$delete_table_row:function(e){this.data.splice(e,1),this.$reader_content(this.data)},$fixed_table_thead:function(e){$(e).scroll(function(){var e=this.scrollTop;this.querySelector("thead").style.transform="translateY("+e+"px)"})},$set_batch_view:function(){var e=$(this.config.el+" .bt_select_value"),t=$(this.config.el+" .bt_table_select_group").next();if(void 0!==this.config.batch){t=$(this.config.el+" .set_batch_option");if(void 0!==this.config.batch.config)this.checkbox_list.length>0?t.removeClass("bt-disabled btn-default").addClass("btn-success").text(lan.public.please_choose+this.batch_active.title+"("+lan.public.selected+this.checkbox_list.length+")"):t.addClass("bt-disabled btn-default").removeClass("btn-success").text(lan.public.please_choose+this.batch_active.title);else{e=$(this.config.el+" .bt_select_value");this.checkbox_list.length>0?(t.removeClass("bt-disabled btn-default").addClass("btn-success").prev().removeClass("bt-disabled"),e.find("em").html("("+lan.public.selected+this.checkbox_list.length+")")):(t.addClass("bt-disabled btn-default").removeClass("btn-success").prev().addClass("bt-disabled"),e.children().eq(0).html(lan.public.please_choose+"<em></em>"),e.next().find("li").removeClass("active"),this.batch_active={})}}return!1},$reader_column_type:function(e,t){var i=t[e.fid],a={},s="",n=[],l=this;switch(e.type){case"text":n=[i,a];break;case"checkbox":n=['<label><i class="cust—checkbox cursor-pointer checkbox_'+this.random+'"></i><input type="checkbox" class="cust—checkbox-input"></label>',a];break;case"password":s="ico_"+l.random+"_";var c='<span class="bt-table-password mr10"><i>**********</i></span>';e.eye_open&&(c+='<span class="glyphicon cursor pw-ico glyphicon-eye-open mr10 '+s+'eye_open" title="Show"></span>',a[s+"eye_open"]||(a[s+"eye_open"]={type:"eye_open_password"})),e.copy&&(c+='<span class="ico-copy cursor btcopy mr10 '+s+'copy" title="Copy"></span>',a[s+"copy"]||(a[s+"copy"]={type:"copy_password"})),n=[c,a];break;case"link":s="click_"+e.fid+"_"+this.random,!a[s]&&e.event&&(a[s]={event:e.event,type:"rows"}),n=['<a class="btlink '+s+'" href="'+(e.href?i:"javascript:;")+'" '+(e.href?'target="'+(e.target||"_blank")+'"':"")+' title="'+i+'">'+i+"</a>",a];break;case"input":blurName="blur_"+e.fid+"_"+this.random,keyupName="keyup_"+e.fid+"_"+this.random,!a[blurName]&&e.blur&&(a[blurName]={event:e.blur,eventType:"blur",type:"rows"}),!a[keyupName]&&e.keyup&&(a[keyupName]={event:e.keyup,eventType:"keyup",type:"rows"}),n=['<input type="text" title="'+lan.site.click_edit+'"  class="table-input '+blurName+" "+keyupName+'" value="'+i+'">',a];break;case"status":var o="";s="click_"+e.fid+"_"+this.random,$.each(e.config.list,function(e,t){t[0]===i&&(o=t)}),!a[s]&&e.event&&(a[s]={event:e.event,type:"rows"}),n=['<a class="btlink '+s+" "+(o[2].indexOf("#")>-1?"":o[2])+'" style="'+(o[2].indexOf("#")>-1?"color:"+o[2]+";":"")+'" href="javascript:;"><span>'+o[1]+"</span>"+(e.config.icon?'<span class="glyphicon '+o[3]+'"></span>':"")+"</a>",a];break;case"switch":break;case"group":var r="";$.each(e.group,function(i,n){if(s=(e.fid?e.fid:"group")+"_"+i+"_"+l.random,n.template){var c=n.template(t,l),o=$(c);o.length>0?r+=o.addClass(s)[0].outerHTML:r+='<a href="javascript:;" class="btlink '+s+'">'+c+"</a>"}else r+='<a href="javascript:;" class="btlink '+s+'" '+(n.hide?'style="display:none;"':"")+">"+n.title+"</a>";r+=e.group.length-1!=i?"&nbsp;|&nbsp;":"",!a[s]&&n.event&&(a[s]={event:n.event,type:"rows"})}),n=[r,a];break;default:n=[i,a]}return n},$reader_tootls:function(e){function t(e,t){var i=bt.load(e.title+lan.site.executing),s={},n=a.$get_data_batch_list(e.paramId,t);e.beforeRequest?s[e.paramName]=e.beforeRequest(t):s[e.paramName]=n.join(","),bt_tools.send({url:e.url||a.config.batch.url,data:$.extend(e.param||{},s)},function(s){if(i.close(),!s.status)return!1;if(void 0===e.tips||e.tips){var n="";$.each(s.error,function(e,t){n+="<tr><td><span>"+e+'</span/></td><td><div style="float:right;" class="size_ellipsis"><span style="color:red">'+t+"</span></div></td></tr>"}),$.each(s.success,function(e,t){n+="<tr><td><span>"+t+'</span></td><td><div style="float:right;" class="size_ellipsis"><span style="color:#20a53a">'+lan.public.success+"</span></div></td></tr>"}),a.$batch_success_table({title:e.title,th:e.theadName,html:n}),a.$refresh_table_list(!0)}e.success&&e.success(s,t,a)})}function i(e,i,a){e.callback?e.callback({loadT:0,config:{},check_list:i,bacth_status:!0,start_batch:function(t,i){var a=this;e.load&&(this.loadT=layer.msg(lan.public.executeing+e.title+'，<span class="batch_progress">'+lan.public.schedule+":0/"+this.check_list.length+"</span>,"+lan.public.please_wait+(e.clear?'<a href="javascript:;" class="btlink clear_batch" style="margin-left:20px;">cancel</a>':""),$.extend({icon:16,skin:"batch_tips",shade:.3,time:0},e.clear?{area:"420px"}:{})),$("#layui-layer"+a.loadT).on("click",".clear_batch",function(){a.clear_bacth()})),this.config={param:t,url:e.url},this.bacth(i)},bacth:function(t,s){var n=this,l={};if("function"==typeof t&&(s=t,t=0),t<this.check_list.length){if(l="function"==typeof e.param?e.param(i[t]):e.param,this.config.param=$.extend(this.config.param,l),e.paramId&&(n.config.param[e.paramId]=n.check_list[t][e.paramId]),this.config.param.bacth&&t==this.check_list.length-1&&delete this.config.param.bacth,!n.bacth_status)return!1;e.load&&$("#layui-layer"+n.loadT).find(".layui-layer-content").html('<i class="layui-layer-ico layui-layer-ico16"></i>'+lan.public.executeing+e.title+'，<span class="batch_progress">'+lan.public.schedule+":"+t+"/"+n.check_list.length+"</span>,"+lan.public.please_wait+(e.clear?'<a href="javascript:;" class="btlink clear_batch" style="margin-left:20px;">cancel</a>':"")),bt_tools.send({url:this.config.url,data:this.config.param,bacth:!0},function(e){$.extend(n.check_list[t],{request:{status:"boolean"==typeof e.status&&e.status,msg:e.msg||lan.public.request_error}}),t++,n.bacth(t,s)})}else a&&a(),s(this.check_list),layer.close(this.loadT)},clear_bacth:function(){this.bacth_status=!1,layer.close(this.loadT)}}):e.confirm?t(e,i):e.confirmVerify?bt.show_confirm(e.title+lan.public.in_bulk,e.title+lan.public.in_bulk+","+lan.public.risk_prompt,t):bt.confirm({title:e.title+lan.public.in_bulk,msg:e.title+lan.public.in_bulk+","+lan.public.risk_prompt},function(){t&&t(e,i)})}for(var a=this,s={},n=0;n<e.length;n++){var l="",c=e[n];switch(c.type){case"group":$.each(c.list,function(e,t){var i=c.type+"_"+a.random+"_"+e;t.group?(l+='<div class="btn-group" style="vertical-align: top;">                                        <button type="button" class="btn btn-default '+i+' btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span style="margin-right:2px;">'+lan.site.category_manager+'</span><span class="caret" style="position: relative;top: -1px;"></span></button>                                        <ul class="dropdown-menu"></ul>                                    </div>',c.list&&$.each(c.list,function(e,t){'<li><a href="javascript:;" NaN'+t[c.key]+"</a></li>"}),t.init&&setTimeout(function(){t.init(i)},400)):l+='<button type="button" class="btn '+(t.active?"btn-success":"btn-default")+" "+i+' btn-sm mr5">'+t.title+"</button>",s[i]||(s[i]={event:t.event,type:"button"})});break;case"search":this.config.search=c;var o="search_input_"+this.random,r="search_btn_"+this.random;l='<div class="bt_search"><input type="text" class="search_input '+o+'" style="'+(c.width?"width:"+c.width:"")+'" placeholder="'+(c.placeholder||"")+'"/><span class="glyphicon glyphicon-search '+r+'" aria-hidden="true"></span></div>',s[o]||(s[o]={eventType:"keyup",type:"search_input"}),s[r]||(s[r]={type:"search_btn"});break;case"batch":this.config.batch=c;var d=[],p="",_=c.config;void 0!==c.config?(a.batch_active=_,$(a.config.el).on("click",".set_batch_option",function(e){for(var s=[],n=0;n<a.checkbox_list.length;n++)s.push(a.data[a.checkbox_list[n]]);if($(this).hasClass("bt-disabled"))return layer.tips(a.config.batch.disabledTips||"Select batch operation",$(this),{tips:[1,"red"],time:2e3}),!1;switch(typeof _.confirm){case"function":_.confirm(_,function(e,t){_.param=$.extend(_.param,e),i(_,s,t)});break;case"undefined":i(_,s);break;case"object":var l=_.confirm;bt.open({title:l.title||"Batch execute",area:l.area||"350px",btn:l.btn||["Confirm","Cancel"],content:l.content,success:function(e,t){l.success(e,t,_)},yes:function(e,i){l.yes(e,i,function(e,i){_.param=$.extend(_.param,e),t(_,s)})}})}})):($.each(c.selectList,function(e,t){t.group?($.each(t.group,function(e,i){d.push($.extend({},t,i)),p+='<li class="item">'+i.title+"</li>"}),delete t.group):(d.push(t),p+='<li class="item">'+t.title+"</li>")}),$(a.config.el).on("click",".bt_table_select_group .bt_select_value",function(e){var t=$(this).parent(),i=t.find(".bt_selects"),s=t.offset(),n=a.$get_win_area();return t.hasClass("bt-disabled")?(layer.tips(a.config.batch.disabledSelectValue,t,{tips:[1,"red"],time:2e3}),!1):(t.hasClass("active")?t.removeClass("active"):t.addClass("active"),i.height()>n[1]-s.top?i.addClass("top"):i.removeClass("top"),$(document).one("click",function(){return $(a.config.el).find(".bt_table_select_group").removeClass("active"),!1}),!1)}),$(a.config.el).on("click",".bt_table_select_group .item",function(e){var t=$(this).text(),i=$(this).index();$(this).addClass("active").siblings().removeClass("active"),$(a.config.el+" .bt_select_tips").html(t+lan.public.in_bulk+"<em>("+lan.site.have_been_selected+a.checkbox_list.length+")</em>"),a.batch_active=d[i],a.checked||$(".bt_table_select_group").removeClass("active")}),$(a.config.el).on("click",".set_batch_option",function(e){var s=[],n=a.batch_active;if($(this).hasClass("bt-disabled"))return layer.tips(a.config.batch.disabledSelectValue,$(this),{tips:[1,"red"],time:2e3}),!1;for(var l=0;l<a.checkbox_list.length;l++)s.push(a.data[a.checkbox_list[l]]);if("{}"===JSON.stringify(n)){var c=$(a.config.el+" .bt_table_select_group");return layer.tips(lan.public.select_opt_type,c,{tips:[1,"red"],time:2e3}),c.css("border","1px solid red"),setTimeout(function(){c.removeAttr("style")},2e3),!1}switch(typeof n.confirm){case"function":n.confirm(n,function(e,t){n.param=$.extend(n.param,e),i(n,s,t)});break;case"undefined":i(n,s);break;case"object":var o=n.confirm;bt.open({title:o.title||lan.public.bulk_opt,area:o.area||"350px",btn:o.btn||[lan.public.confirm,lan.public.cancel],content:o.content,success:function(e,t){o.success(e,t,n)},yes:function(e,i){o.yes(e,i,function(e,i){n.param=$.extend(n.param,e),t(n,s)})}})}})),l='<div class="bt_batch"><label><i class="cust—checkbox cursor-pointer checkbox_'+this.random+'" data-checkbox="all"></i><input type="checkbox" lass="cust—checkbox-input" /></label>'+(void 0!==c.config?'<button class="btn btn-default btn-sm set_batch_option bt-disabled">'+c.config.title+"</button>":'<div class="bt_table_select_group bt-disabled not-select"><span class="bt_select_value"><span class="bt_select_tips">'+lan.public.select_opt_type+'<em></em></span><span class="glyphicon glyphicon-triangle-bottom ml5"></span></span><ul class="bt_selects ">'+p+'</ul></div><button class="btn btn-default btn-sm set_batch_option bt-disabled" >'+c.buttonValue+"</button>")+"</div>";break;case"page":this.config.page=c;var h=bt.get_cookie(this.config.cookiePrefix+"_"+this.config.page.numberParam);this.config.cookiePrefix&&h&&(this.config.page.number=h),l=this.$reader_page(this.config.page,'<div><span class="Pcurrent">1 </span><span class="Pcount">'+lan.public_backup.total+"</span></div>")}if(l){var f=$(a.config.el+" .tootls_"+c.positon[1]);if(f.length){var u=f.find(".pull-"+c.positon[0]);u.append(l)}else{var v='<div class="tootls_group tootls_'+c.positon[1]+'"><div class="pull-left">'+("left"==c.positon[0]?l:"")+'</div><div class="pull-right">'+("right"==c.positon[0]?l:"")+"</div></div>";"top"===c.positon[1]?($(a.config.el).append(v),0===$(a.config.el+" .divtable").length&&$(a.config.el).append('<div class="divtable mtb10"></div>')):(0===$(a.config.el+" .divtable").length&&$(a.config.el).append('<div class="divtable mtb10"></div>'),$(a.config.el).append(v))}}}this.init||this.$event_bind(s)},$get_data_batch_list:function(e,t){var i=[];return $.each(t||this.data,function(t,a){i.push(a[e])}),i},$reader_page:function(e,t){var i=this,a=$(t),s="",n={};if(a.find("a").addClass("page_link_"+this.random),s+=a.html(),e.numberStatus){var l="page_select_"+this.random;s+='<select class="page_select_number '+l+'">',$.each(e.numberList,function(t,i){s+='<option value="'+i+'" '+(e.number==i?"selected":"")+">"+i+lan.site.items_page+"</option>"}),s+="</select>",n[l]={eventType:"change",type:"page_select"}}if(e.jump){var c="page_jump_input-"+this.random,o="page_jump_btn_"+this.random;s+='<div class="page_jump_group"><span class="page_jump_title">'+lan.public.jump_to_page+'</span><input type="number" class="page_jump_input '+c+'" value="'+e.page+'" /><span class="page_jump_title"></span><button type="button" class="page_jump_btn '+o+'">'+lan.public.confirm+"</button></div>",n[c]={eventType:"keyup",type:"page_jump_input"},n[o]={type:"page_jump_btn"}}return n["page_link_"+this.random]={type:"cut_page_number"},i.config.page.total=parseInt(a.find(".Pcount").html().match(/([0-9]*)/g)[1]),i.$event_bind(n),'<div class="page">'+s+"</div>"},$dynamic_merge_style:function(e,t){var i="";return $.each(e,function(e,t){switch(e){case"align":i+="text-align:"+t+";";break;case"width":i+="width:"+("string"==typeof t?t:t+"px")+";";break;case"style":i+=t;break;case"minWidth":i+="min-width:"+("string"==typeof t?t:t+"px")+";";break;case"maxWidth":i+="max-width:"+("string"==typeof t?t:t+"px")+";"}}),{index:t,css:i}},$event_bind:function(e){var t=this;$.each(e,function(e,i){if(t.event_list[e]&&t.event_list[e].eventType===i.eventType)return!0;t.event_list[e]=i,$(t.config.el).on(i.eventType||"click","."+e,function(a){var s=$(this).parents("tr").index(),n=$(this).data(),l=[];switch(i.type){case"rows":t.event_rows_model={el:$(this),model:t.config.column[$(this).parents("td").index()],rows:t.data[s],index:s},l=[t.event_rows_model.rows,t.event_rows_model.index,a,e,t];break;case"sort":var c=t.config.column[n.index];$(this).hasClass("sort-active")&&$(".sort_"+t.random+" .sort-active").data({sort:"desc"}),$(".sort_"+t.random).removeClass("sort-active").find(".glyphicon").removeClass("glyphicon-triangle-top").addClass("glyphicon-triangle-bottom"),$(this).addClass("sort-active"),"asc"==n.sort?($(this).data({sort:"desc"}),$(this).find(".glyphicon").removeClass("glyphicon-triangle-top").addClass("glyphicon-triangle-bottom")):($(this).data({sort:"asc"}),$(this).find(".glyphicon").removeClass("glyphicon-triangle-bottom").addClass("glyphicon-triangle-top")),t.config.sort=t.config.sortParam({name:c.fid,sort:n.sort}),t.$refresh_table_list(!0);break;case"checkbox":var o=$(t.config.el+' [data-checkbox="all"]'),r=$(t.config.el+" tbody .checkbox_"+t.random);null==n.checkbox?$(this).hasClass("active")?($(this).removeClass("active"),t.checkbox_list.splice(t.checkbox_list.indexOf(s),1),t.checkbox_list.length>0?o.addClass("selected").removeClass("active"):o.removeClass("selected active")):($(this).addClass("active"),t.checkbox_list.push(s),t.data.length===t.checkbox_list.length?o.addClass("active").removeClass("selected"):t.checkbox_list.length>0&&o.addClass("selected")):t.checkbox_list.length===t.data.length?(t.checkbox_list=[],r.removeClass("active selected").next().prop("checked","checked"),o.removeClass("active")):(r.each(function(e,i){$(this).hasClass("active")||($(this).addClass("active").next().prop("checked","checked"),t.checkbox_list.push(e))}),o.removeClass("selected").addClass("active")),t.$set_batch_view();break;case"button":l.push(a,t);break;case"search_focus":var d=$(t.config.el+" .bt_search_tips");$(t.config.el+" .bt_search_tips").length>0&&d.remove();break;case"search_input":if(13==a.keyCode)return $(t.config.el+" .search_btn_"+t.random).click(),!1;break;case"search_btn":var p=$(t.config.el+" .search_input"),_=$(t.config.el+" .search_input").val();t.config.search.value=_,p.append('<div class="bt_search_tips"><span>'+_+'</span><i class="bt_search_close"></i></div>'),t.$refresh_table_list(!0);break;case"page_select":var h=parseInt($(this).val());return t.config.page.number=h,t.config.page.page=1,t.$refresh_table_list(!0),!1;case"page_jump_input":return 13==a.keyCode&&($(t.config.el+" .page_jump_btn_"+t.random).click(),$(this).focus()),!1;case"page_jump_btn":var f=parseInt($(t.config.el+" .page_jump_input-"+t.random).val()),u=Math.ceil(t.config.page.total/t.config.page.number);f>u&&(f=t.config.page.page),t.config.page.page=f,t.$refresh_table_list(!0);break;case"cut_page_number":var v=parseInt($(this).attr("href").match(/([0-9]*)$/)[0]);return t.config.page.page=v,t.$refresh_table_list(!0),!1;case"eye_open_password":return $(this).hasClass("glyphicon-eye-open")?($(this).addClass("glyphicon-eye-close").removeClass("glyphicon-eye-open"),$(this).prev().text(t.data[s].password)):($(this).addClass("glyphicon-eye-open").removeClass("glyphicon-eye-close"),$(this).prev().html("<i>**********</i>")),!1;case"copy_password":return bt.pub.copy_pass(t.data[s].password),!1}i.event&&i.event.apply(this,l)})})},$style_bind:function(e,t){var i="",a=this;$.each(e,function(e,t){""!=t.css&&(t.className?i+=t.className+"{"+t.css+"}":i+=a.config.el+" thead th:nth-child("+(t.index+1)+"),"+a.config.el+" tbody tr td:nth-child"+(t.span?" span":"")+"("+(t.index+1)+"){"+t.css+"}")}),0==$("#bt_table_"+a.random).length&&$(a.config.el).append('<style type="text/css" id="bt_table_'+a.random+'">'+i+"</style>")},$get_win_area:function(){return[window.innerWidth,window.innerHeight]},$http:function(e){var t={},i=this.config,a=i.page,s=i.search,n=i.sort||{};a&&(t[a.numberParam]=a.number,t[a.pageParam]=a.page,this.config.cookiePrefix&&bt.set_cookie(this.config.cookiePrefix+"_"+a.numberParam,a.number)),s&&(t[s.searchParam]=s.value),this.config.beforeRequest&&(i.param=this.config.beforeRequest(i.param)),bt_tools.send({url:i.url,data:$.extend(i.param,t,n)},function(t){if(i.dataFilter){var a=i.dataFilter(t);e&&e(a.data,a.page)}else e&&e(t.data,t.page)})}},new t(e)},select_file:function(e,t){"string"==typeof e&&(e={path:e,type:2,title:lan.public.select_fileordir,ext:[],limit:""}),"function"==typeof e&&(type=t,t=e,e={path:bt.get_cookie("Path")}),"number"!=typeof type&&(type=0);var i=this,a={type:type,type_tips:0==type?lan.public.dir:1==type?lan.site.file:lan.public.fileordir,select_list:[],select_path:bt.get_cookie("Path")||("Windows"==bt.os?setup_path:"/www/wwwroot"),select_config:{},scroll_width:0,reader_view:function(){var t=this;this.scroll_width=a.getScrollbarWidth(),layer.open({type:1,title:e.title||lan.public.select+t.type_tips,shadeClose:!1,closeBtn:1,area:["650px","550px"],content:'<div id="select_file_style"></div><div id="select_file_directory" class="select_file_content"><div class="file_path_views"><div class="forward_path"><span class="active" title="'+lan.public.back+'"><i class="iconfont icon-arrow-lift"></i></span><span class="active" title="'+lan.public.next+'"><i class="iconfont icon-arrow-right"></i></span><span class="file_return_level" title="'+lan.public.return+'"><i class="iconfont icon-prev"></i></span></div><div class="file_path_input"><div class="file_path_shadow"></div><div class="file_dir_view" data-width="244"></div><input type="text" data-path="C:/BtSoft/backup" class="path_input"></div><div class="file_path_refresh" title="'+lan.public.fresh+'"><i class="iconfont icon-shuaxin"></i></div><div class="search_path_views"><input type="text" placeholder="'+lan.public.search_file_name+'" class="file_search_input"><button type="submit" class="path_btn"><i class="iconfont icon-search"></i></button></div></div><div class="select_file_tootls"><button type="button" class="select_btn">'+lan.bt.adddir+'</button></div><div class="select_file_body"><div class="select_mount_list not-select" id="select_mount_list"></div><div class="select_dir_list not-select"><div class="select_list_thaed"><table class="mask_thead"><thead><tr><th data-type="filename"><span>'+lan.public.name+'</span><i class="iconfont icon-xiala"></i><i class="icon-drag"></i></th><th data-type="mtime"><span>'+lan.public.modify_time+'</span><i class="iconfont icon-xiala"></i><i class="icon-drag"></i></th><th data-type="type" class="active"><span>'+lan.site.redirect_type+'</span><i class="iconfont icon-xiala"></i><i class="icon-drag"></i></th></tr></thead></table><div class="select_list_shadow"></div></div><div class="select_list_body"><table><thead><tr><th><span>文件</span><i></i></th><th><span>修改时间</span><i></i></th><th><span>类型</span><i></i></th></tr></thead><tbody id="select_dir_list"></tbody></table></div></div></div><div class="select_file_group"><div class="select-line"><span class="select-line-name">'+t.type_tips+'名:</span><div class="select-line-content"><input type="text" name="select_name" class="file_directory" /></div></div><div class="select_btn_group"><button class="btn btn-success btn-sm" type="button">选择'+t.type_tips+'</button><button class="btn btn-default btn-sm" type="button">取消</button></div></div></div>',success:function(){t.evnet_bind(),t.render_file_list(function(){t.set_path_width()}),$(".select_list_thaed").css("right",t.scroll_width+"px")}})},evnet_bind:function(){var e=this;$("#select_dir_list").on("click","tr",function(){var t=$(this).data("index");$(this).addClass("active").siblings().removeClass("active"),$('[name="select_name"]').val(e.select_list[t].filename)}),$(".select_list_body").on("scroll",function(e){var t=$(this).scrollTop(),i=$(this).scrollLeft();t>0?$(".select_list_shadow").show():$(".select_list_shadow").hide(),i>=0&&$(".select_list_thaed").css("left",4-i+"px"),e.stopPropagation(),e.preventDefault()}),$(".file_path_refresh").on("click",function(){e.render_file_list()}),$(".select_dir_list thead th .icon-drag").on("mousedown",function(t){var i=t.clientX,a=$(this).parent(),s=a.index(),n=a[0].clientWidth;parseInt($(this).parent().attr("data-min"));if(1===t.which){var l=function(t){var a=t.clientX,l=a-i,c=n+l;setTimeout(function(){e.set_select_width(s,"width:"+c+"px")},0)};$(document).on("mousemove",l).one("mouseup",function(){$(this).unbind(l),$(this).unbind(this)})}t.stopPropagation()}),$(".select_dir_list thead th>span").on("click",function(t){var i=$(this).parent(),a=i.data("type"),s=i.hasClass("active"),n=i.hasClass("sort");s?i.addClass("sort").removeClass("active"):n?i.addClass("active").removeClass("sort"):i.addClass("active"),i.siblings().removeClass("active sort"),e.render_file_list({sort:a,reverse:s?1:0}),t.stopPropagation()}),$(".search_path_views input").on("keyup",function(){$(this).val()})},set_path_width:function(e){var t=0,i=$(".file_dir_view")[0].offsetWidth,a=($(".file_dir_view .file_dir_item"),[]);t=0;$(".file_dir_view .file_dir_item").each(function(){a.push($(this)[0].offsetWidth)});for(var s=a.reverse(),n=0;n<s.length;n++)if(t+=s[n],i-t<=60)return $(".file_dir_omit").removeClass("hide").find(".nav_down_list").html($(".file_dir_view .file_dir_item:lt("+n+")")),$(".file_dir_view .file_dir_item").show(),$(".file_dir_view .file_dir_item:lt("+n+")").hide(),!1},render_file_list:function(e,t){var a="",s="",n=this,l={path:this.select_path,sort:"type",disk:!0};void 0===e&&(e=l),"function"==typeof e&&(t=e,e=l),n.select_config=$.extend(l,e),i.send({url:"/files?action=GetDir",data:n.select_config},function(e){var i=e.DIR,l=e.FILES,c=e.DISK,o=[];$.each(l,function(e,t){var i=t.split(";"),a=i[0].split("."),s=bt.format_data(i[2]);o.push({type:"file",filename:i[0],ext:a[a.length-1],size:i[1],accept:i[3],mtime:s})}),$.each(i,function(e,t){var i=t.split(";"),a=bt.format_data(i[2]);o.push({type:"dir",filename:i[0],size:i[1],accept:i[3],mtime:a})}),n.select_list=o,n.render_path_list(e.PATH),$.each(c,function(e,t){var i="/"==t.path?"根目录":t.path.indexOf(":/")>-1?"本地磁盘("+t.path.match(/[A-Z]+/)[0]+":)":t.path;a+='<div class="item" data-menu="'+t.path+'" title="名称:&nbsp;'+i+"\n路径:&nbsp;"+t.path+"\n总容量:&nbsp;"+t.size[0]+"\n可用容量:&nbsp;"+t.size[2]+'"><span class="glyphicon glyphicon-hdd mr5"></span><span>'+i+"</span></div>"}),$.each(o,function(e,t){var i=bt.format_data(t.mtime),a="dir"==t.type?"文件夹":"文件";s+='<tr data-index="'+e+'" title="名称：'+t.filename+"\r修改时间:"+i+"\r类型："+a+'">                            <td><span><i class="'+t.type+'-icon"></i><span>'+t.filename+"</span></span></td>                            <td><span>"+i+"</span></td>                            <td><span>"+("dir"==t.type?"文件夹":"文件")+"</span></td>                        </tr>"}),$("#select_mount_list").html(a),$("#select_dir_list").html(s),t&&t(e)})},render_path_list:function(e,t){var i='<div class="file_dir_omit hide" title="展开已隐藏的目录"><span></span><i class="iconfont icon-zhixiang-zuo"></i><div class="nav_down_list"></div></div>',a="",s=e.split("/").splice(1),n=e.split("/")[0];"Windows"===bt.os?(0==s.length&&(s=[]),s.unshift('<span class="glyphicon glyphicon-hdd"></span><span class="ml5">本地磁盘('+n+")</span>")):("/"==e&&(s=[]),s.unshift("根目录"));for(var l=0;l<s.length;l++)a+="/"+s[l],0==l&&(a=""),i+='<div class="file_dir_item">                        <span class="file_dir" title="'+(n+a)+'">'+s[l]+'</span>                        <i class="iconfont icon-arrow-right"></i>                        <ul class="nav_down_list">                            <li data-path="*"><span>加载中</span></li>                        </ul>                    </div>';$(".path_input").val("").attr("data-path",e);var c=$("#select_file_directory .file_path_input .file_dir_view");c.html(i),t&&t(e)},set_select_width:function(e,t){var i=".select_dir_list tbody td:nth-child("+(e+1)+")>span,.select_dir_list thead th:nth-child("+(e+1)+")>span",a=$("#th-index-"+e);a.length>0?a.html(i+"{"+t+"}"):$("#select_file_style").append('<style type="text/css" id="th-index-'+e+'">'+i+"{"+t+"}</style>")},cut_style_object:function(e){var t={};e.split(";");return t},getScrollbarWidth:function(){var e,t,i=document.createElement("div"),a={width:"100px",height:"100px",overflowY:"scroll"};for(e in a)i.style[e]=a[e];return document.body.appendChild(i),t=i.offsetWidth-i.clientWidth,i.remove(),t}};a.reader_view()},form:function(e){function t(e){this.config=e,this.$load()}var i=this;return t.prototype={element:null,style_list:[],event_list:{},event_type:["click","event","focus","keyup","blur","change"],hide_list:[],form_element:{},form_config:{},random:bt.get_random(5),$load:function(){var e=this;e.el&&this.$reader_content(function(){e.$event_bind()})},$active_focus:function(e,t){var i=this;$(".input_checked_"+i.random).focus(),this.checked_blur=function(a){setTimeout(function(){if(t)return $(".input_checked_"+i.random).focus(),!1;e&&e(a),delete i.checked_blur},200)}},$reader_content:function(e){var t=this,a="",s="",n={};return $.each(t.config.form,function(e,i){a+=t.$reader_content_row(e,i)}),t.element=$('<form class="bt-form" data-form="'+t.random+'">'+a+"</form>"),s=$('<div class="'+i.$verify(t.config.class)+'"><input type="checkbox" class="blur_checked input_checked_'+t.random+'"></div>'),s.append(t.element),n["input_checked_"+t.random]={focus:{type:"input_checked",onEvent:!1,event:function(e,t){return t.checked=!0,!1}},blur:{type:"input_checked",onEvent:!1,event:function(e,t){t.checked=!1,t.checked_blur&&t.checked_blur(e)}}},
$.extend(t.event_list,n),e&&e(),s[0].outerHTML},$reader_content_row:function(e,t){var a=this,s=t.help;return'<div class="line'+i.$verify(t.class)+i.$verify(t.hide,"hide",!0)+'"'+i.$verify(t.id,"id")+">"+(t.label?'<span class="tname">'+t.label+"</span>":"")+'<div class="'+(t.label?"info-r":"")+i.$verify(t.line_class)+'"'+i.$verify(a.$reader_style(t.line_style),"style")+">"+a.$reader_form_element(t.group,e)+(s?'<div class="c9 mt5 '+i.$verify(s.class,"class")+'" '+i.$verify(a.$reader_style(s.style),"style")+">"+s.list.join("</br>")+"</div>":"")+"</div></div>"},$reader_form_element:function(e,t){var a=this,s="",n={};return Array.isArray(e)||(e=[e]),$.each(e,function(e,l){var c=a.$reader_style(l.style)+i.$verify(l.width,"width","style"),o=a.$verify_group(l,["name","value","placeholder","disabled","readonly","autofocus","autocomplete","min","max"]),r=a.$create_event_config(l),d="";switch(s+=l.label?'<span class="mr5">'+l.label+"</span>":"",void 0!==l.name&&(n[l.name]=r),l.type){case"text":case"checkbox":case"password":case"radio":case"number":var p="event_"+l.name+"_"+a.random,_="checkbox"===l.type;"radio"===l.type?$.each(l.label_tips,function(e,t){l.block&&(s+='<div class="block '+(l.block_class?l.block_class:"")+'">'),s+='<input type="'+l.type+'"'+o+" "+(l.icon?'id="'+p+'"':"")+' class="bt-input-'+("select_path"!=l.type?l.type:"text")+" mr10 "+(l.label?"form_middle":"")+i.$verify(l.class,"class")+'"'+i.$verify(c,"style")+" "+(_?'id="'+a.random+"_"+l.name+'"':"")+" "+(0==e?"checked":"")+' id="'+a.random+"_"+l.name+e+'"/>',s+='<label for="'+a.random+"_"+l.name+e+'">'+t+"</label>",l.block&&(s+="</div>")}):(l.block&&(s+='<div class="block '+(l.hide?"hide":"")+" "+(l.block_class?l.block_class:"")+'">'),s+='<input type="'+l.type+'"'+o+" "+(l.icon?'id="'+p+'"':"")+' class="bt-input-'+("select_path"!=l.type?l.type:"text")+" mr10  "+p+(l.label?"form_middle":"")+i.$verify(l.class,"class")+'"'+i.$verify(c,"style")+" "+(_?'id="'+a.random+"_"+l.name+'"':"")+"/>","checkbox"==l.type&&(s+='<label for="'+a.random+"_"+l.name+'">'+l.label_tips+"</label>"),l.block&&(s+="</div>"),a.event_list[p]={click:{event:l.event}}),l.icon&&(s+='<span class="glyphicon '+l.icon.type+" "+l.name+'_icon cursor" '+i.$verify(a.$reader_style(l.icon.style),"style")+"></span>",n[l.name+"_icon"]={click:{type:"select_path",config:l}});break;case"textarea":if(s+='<textarea class="bt-input-text"'+i.$verify(c,"style")+o+" >"+(l.value||"")+"</textarea>",$.each(["blur","focus","input"],function(e,t){if(l.tips){var i=null;switch(t){case"blur":i=function(e,t){""===$(this).val()&&$(this).next().show(),layer.close(t.tips.loadT)};break;case"focus":i=function(e,t){$(this).next().hide(),t.tips.loadT=layer.tips(h,$(this),{tips:[1,"#20a53a"],time:0,area:$(this).width()})}}}n[l.name][t]?n[l.name][t].added=i:n[l.name][t]={type:l.type,cust:!1,event:l[t],added:i}}),l.tips){var h="";h=void 0===l.tips.list?l.tips.text:l.tips.list.join("</br>"),s+='<div class="placeholder c9 '+l.name+'_tips" '+i.$verify(a.$reader_style(l.tips.style),"style")+">"+h+"</div>",n[l.name+"_tips"]={click:{type:"textarea_tips",config:l}}}break;case"select":s+=a.$reader_select(l,c,o,t),a.event_list.custom_select={click:{type:"custom_select",children:".bt_select_value"}},a.event_list.custom_select_item={click:{type:"custom_select_item",children:"li.item"}};break;case"link":d="event_"+bt.get_random(6),s+='<a href="'+(l.href||"javascript:;")+'" class="btlink offsetY7'+i.$verify(l.class,"class")+" "+d+'" '+i.$verify(a.$reader_style(l.style),"style")+">"+l.title+"</a>",a.event_list[d]={click:{type:"link_event",event:l.event}};break;case"help":var f="";$.each(l.list,function(e,t){f+="<li>"+t+"</li>"}),s+='<ul class="help-info-text c7'+i.$verify(l.class)+'"'+i.$verify(a.$reader_style(l.style),"style")+">"+f+"</ul>"}a.form_config[l.name]=l}),$.extend(a.event_list,n),s},$create_event_config:function(e){var t={};return void 0===e.name?{}:($.each(this.event_type,function(i,a){e[a]&&(t["event"===a?"click":a]={type:e.type,event:e[a],cust:["select","checkbox","radio"].indexOf(e.type)>-1,config:e})}),t)},$reader_style:function(e){var t="";return"string"==typeof e?e:void 0===e?"":($.each(e,function(e,i){t+=e+":"+i+";"}),t)},$reader_select:function(e,t,a,s){var n=this,l="",c="",o={};if(!Array.isArray(e.list)){var r=e.list;bt_tools.send({url:r.url,data:r.param||{}},function(t){!1!==t.status?(e.list=e.list.dataFilter?e.list.dataFilter(t):t,n.$replace_render_content(s)):bt.msg(t)})}return $.each(e.list,function(t,a){o=a.value===e.value||a.value===n.config.data[e.name]?a:e.list[0],l+='<li class="item'+i.$verify(a.value===o.value?"active":"")+" "+(a.disabled?"disabled":"")+'">'+a.title+"</li>",c+='<option value="'+a.value+'"'+(a.disabled?"disabled":"")+" "+i.$verify(a.value===o.value?"selectd":"")+">"+a.title+"</option>"}),!o.title&&Array.isArray(e.list)&&(o=e.list[0]),'<div class="bt_select_updown mr10 '+(e.disabled?"bt_disabled":"")+" "+i.$verify(e.hide,"hide",!0)+i.$verify(e.class)+'" '+i.$verify(t,"style")+' data-name="'+e.name+'"><span class="bt_select_value"><span class="bt_select_content">'+(o.title||"Getting data")+'</span><span class="glyphicon glyphicon-triangle-bottom ml5"></span></span><ul class="bt_select_list">'+(l||"")+"</ul><select"+a+' class="hide" '+(e.disabled?"disabled":"")+">"+(c||"")+"</select></div>"},$replace_render_content:function(e){var t=this,i=this.config.form[e];$("[data-form="+t.random+"]").find(".line:eq("+e+")").replaceWith(t.$reader_content_row(e,i))},$event_bind:function(e,t){var i=this,a={};i.element=$("object"==typeof e?i.element:"[data-form="+i.random+"]"),void 0===e&&(a=i.event_list),$.each(a,function(e,t){if($.isEmptyObject(t))return!0;$.each(t,function(t,a){var s="";s="boolean"==typeof a.cust?"["+(a.cust?"data-":"")+"name="+e+"]":"."+e,function(e,a){if(!1===e.onEvent){switch(e.type){case"input_checked":$(s).on("event"!=t?t:"click",function(t){e.event.apply(this,[t,i])})}return!0}i.element.on("event"!=t?t:"click",e.children?e.children:s,function(t){var s=i.$get_form_element(),n=i.$get_form_value(),l=i.form_config[a];switch(e.type){case"textarea_tips":$(this).hide().prev().focus();break;case"custom_select":if($(this).parent().hasClass("bt-disabled"))return!1;var c=$(this).next();return c.hasClass("show")?c.removeClass("show"):($(".bt_select_list").removeClass("show"),c.addClass("show")),$(document).click(function(){return i.element.find(".bt_select_list").removeClass("show"),$(this).unbind("click"),!1}),!1;case"custom_select_item":if(l=i.form_config[$(this).parents(".bt_select_updown").attr("data-name")],item_config=l.list[$(this).index()],$(this).hasClass("disabled"))return $(this).parent().removeClass("show"),item_config.tips&&layer.msg(item_config.tips,{icon:2}),!0;$(this).hasClass("active")||$(this).hasClass("disabled")||($(this).parent().prev().find(".bt_select_content").text($(this).text()),$(this).addClass("active").siblings().removeClass("active"),$(this).parent().next().val(item_config.value.toString()),$(this).parent().removeClass("show"),$(this).parent().next().trigger("change"));break;case"select_path":bt.select_path("event_"+$(this).prev().attr("name")+"_"+i.random)}e.event&&e.event.apply(this,[n,s,i,l,t]),e.added&&e.added.apply(this,[t,l])})}(a,e)})}),t&&t()},$get_form_value:function(){return this.element.serializeObject()},$set_find_value:function(e,t){var i={},a=this;"string"!=typeof e?i=e:i[e]=t,$.each(i,function(e,t){a.form_element[e].val(t)})},$get_form_element:function(e){var t={},i=this;if(!e&&!$.isEmptyObject(i.form_element))return i.form_element;this.element.find(":input").each(function(e){t[$(this).attr("name")]=$(this)}),i.form_element=t},$verify_group:function(e,t){var i="";return $.each(t,function(t,a){if(void 0===e[a])return!0;["disabled","readonly"].indexOf(a)>-1?i+=" "+(e[a]?a+'="'+a+'"':""):i+=" "+a+'="'+e[a]+'"'}),i},$verify_bind_event:function(e,t,i){var a={};return $.each(i,function(i,s){var n=t[s];n&&("object"==typeof a[e]?(Array.isArray(a[e])||(a[e]=[a[e]]),a[e].push({event:n,eventType:s})):a[e]={event:n,eventType:s})}),a},$verify:function(e,t,i){return e?!0===i?e?" "+t:"":"style"===i?t?t+":"+e+";":e:t?" "+t+'="'+e+'"':" "+e:""},$submit:function(e,t){}},new t(e)},tab:function(e){function t(e){this.config=e,this.theme=this.config.theme||{},this.$load()}var i=this;return t.prototype={type:1,theme_list:[{content:"tab-body",nav:"tab-nav",body:"tab-con",active:"on"},{content:"bt-w-body",nav:"bt-w-menu",body:"bt-w-con"}],random:bt.get_random(5),$init:function(){var e=this,t=(this.config.active,e.config.list);this.$event_bind(),t[e.active].success&&t[e.active].success(),t[e.active].init=!0},$load:function(){},$reader_content:function(){var e=this,t=e.config.list,a="",s="",n=e.theme,l=e.config;return void 0===e.active&&(e.active=0),$.isEmptyObject(l.theme)||(n=this.theme_list[e.active],$.each(l.theme,function(e,t){n[e]&&(n[e]+=" "+t)}),e.theme=n),l.type&&$.isEmptyObject(l.theme)&&(this.theme=this.theme_list[e.active]),$.each(t,function(t,i){var l=e.active===t,c=n.active||"active";a+='<span class="'+(l?c:"")+'">'+i.title+"</span>",s+='<div class="tab-block '+(l?c:"")+'">'+(l?i.content:"")+"</div>"}),e.element=$('<div id="tab_'+e.random+'" class="'+n.content+i.$verify(e.config.class)+'"><div class="'+n.nav+'" >'+a+'</div><div class="'+n.body+'">'+s+"</div></div>"),e.element[0].outerHTML},$reader_find:function(){},$event_bind:function(){var e=this,t=e.theme,i=t.active||"active";e.el||(e.element=$("#tab_"+e.random)),e.element.on("click","."+t.nav.replace(/\s+/g,".")+" span",function(){var a=$(this).index(),s=e.config.list[a];$(this).addClass(i).siblings().removeClass(i),$("."+t.body+">div:eq("+a+")").addClass(i).siblings().removeClass(i),e.active=a,s.init||($("."+t.body+">div:eq("+a+")").html(s.content),s.success&&s.success(),s.init=!0)})}},new t(e)},load:function(e){var t=layer.msg(e+",please wait...",{icon:16,time:0,shade:.3});return!0===e&&(t=layer.load()),{close:function(){layer.close(t)}}},open:function(e){var t={},i=null;return t=$.extend({type:1,area:"640px",closeBtn:2,btn:["确认","取消"]},e),i=layer.open(t),{close:function(){layer.close(i)}}},msg:function(e,t){var i=null,a="",s={};return"object"==typeof e&&"boolean"==typeof e.status&&(a=e.msg,s={icon:e.status?1:2}),"string"==typeof e&&(a=e,s={icon:void 0!==t?t:1}),i=layer.msg(a,s),{close:function(){layer.close(i)}}},$verify:function(e,t,i){return e?!0===i?e?" "+t:"":"style"===i?t?t+":"+e+";":e:t?" "+t+'="'+e+'"':" "+e:""},select_path:function(e,t,i,a){"number"!=typeof i&&(i=1),"number"!=typeof a&&(a=!1),bt.set_cookie("Path","/www/server/panel/BTPanel/static");var s=this,n={type:i,type_tips:0==i?"目录":1==i?"文件":"目录或文件",type_limit:0==i?"dir":1==i?"file":"all",select_list:[],select_path:bt.get_cookie("Path")||("Windows"==bt.os?setup_path:"/www/wwwroot"),select_config:{},scroll_width:0,file_path:bt.get_cookie("Path"),file_operating:[],area:[window.innerWidth,window.innerHeight],reader_view:function(){var t=this;this.scroll_width=n.getScrollbarWidth(),layer.open({type:1,title:e.title||"选择"+t.type_tips,shadeClose:!1,closeBtn:2,area:["650px","555px"],content:'<div id="select_file_style"></div>                        <div id="select_file_directory" class="select_file_content">                            <div class="file_path_views">                                <div class="forward_path">                                    <span title="后退"><i class="iconfont icon-arrow-lift"></i></span>                                    <span title="前进" class="active"><i class="iconfont icon-arrow-right"></i></span>                                    <span class="file_return_level" title="上一层"><i class="iconfont icon-prev"></i></span>                                </div>                                <div class="file_path_input">                                    <div class="file_path_shadow"></div>                                    <div class="file_dir_view" data-width="244"></div>                                    <input type="text" data-path="C:/BtSoft/backup" class="path_input">                                </div>                                <div class="file_path_refresh" title="刷新列表"><i class="iconfont icon-shuaxin"></i></div>                                <div class="search_path_views">                                    <input type="text" placeholder="搜索文件名" class="file_search_input">                                    <div class="search_dir_all" style="display: none;">                                        <input type="checkbox" style="display:none;"/>                                        <span class="file_check" data-type="all" data-checkbox="0"></span>                                        <span>包含子目录</span>                                    </div>                                    <button type="submit" class="path_btn"><i class="iconfont icon-search"></i></button>                                </div>                            </div>                            <div class="select_file_tootls"><button type="button" class="creat_dir">新建文件夹</button></div>                            <div class="select_file_body">                                <div class="select_mount_list not-select" id="select_mount_list"></div>                                <div class="select_dir_list not-select">                                    <div class="select_list_thaed">                                        <table class="mask_thead">                                            <thead><tr><th data-type="filename"><span>名称</span><i class="iconfont icon-xiala"></i><i class="icon-drag"></i></th><th data-type="mtime"><span>修改时间</span><i class="iconfont icon-xiala"></i><i class="icon-drag"></i></th><th data-type="type" class="active"><span>类型</span><i class="iconfont icon-xiala"></i><i class="icon-drag"></i></th></tr></thead>                                        </table>                                        <div class="select_list_shadow"></div>                                    </div>                                    <div class="select_list_body">                                        <table>                                            <thead><tr><th><span>文件</span><i></i></th><th><span>修改时间</span><i></i></th><th><span>类型</span><i></i></th></tr></thead>                                            <tbody id="select_dir_list"></tbody>                                        </table>                                    </div>                                </div>                            </div>                            <div class="select_file_group">                                <div class="select-line">                                    <span class="select-line-name">'+t.type_tips+'名:</span>                                    <div class="select-line-content">                                        <input type="text" name="select_name" class="file_directory" />                                    </div>                                </div>                                <div class="select_btn_group">                                    <button class="btn btn-success btn-sm" type="button">选择'+("目录或文件"==t.type_tips?"":t.type_tips)+'</button>                                    <button class="btn btn-default btn-sm" type="button">取消</button>                                </div>                            </div>                        </div>',success:function(){t.render_file_list(),$(".select_list_thaed").css("right",t.scroll_width+"px")}})},render_file_list:function(e,t){var i="",a="",n=this,l={path:this.select_path,sort:"type",disk:!0};void 0===e&&(e=l),"function"==typeof e&&(t=e,e=l),n.select_config=$.extend(l,e),s.$http("GetDir",n.select_config,function(e){var s=e.DISK,l=$.merge(n.data_reconstruction(e.DIR,"DIR"),n.data_reconstruction(e.FILES));n.select_list=l,n.render_path_list(),$.each(s,function(e,t){var a="/"==t.path?"根目录":t.path.indexOf(":/")>-1?"本地磁盘("+t.path.match(/[A-Z]+/)[0]+":)":t.path;i+='<div class="item" data-menu="'+t.path+'" title="名称:&nbsp;'+a+"\n路径:&nbsp;"+t.path+"\n总容量:&nbsp;"+t.size[0]+"\n可用容量:&nbsp;"+t.size[2]+'"><span class="glyphicon glyphicon-hdd mr5"></span><span>'+a+"</span></div>"}),$.each(l,function(e,t){if(0==n.type&&t.type!=n.type_limit)return!0;var i=bt.format_data(t.mtime),s="dir"==t.type?"文件夹":"文件";a+='<tr data-index="'+e+'" title="名称：'+t.filename+"\r修改时间:"+i+"\r类型："+s+'" data-path="'+t.filename+'" data-type="'+t.type+'">                            <td><span><i class="'+t.type+'-icon"></i><span>'+t.filename+"</span></span></td>                            <td><span>"+i+"</span></td>                            <td><span>"+("dir"==t.type?"文件夹":"文件")+"</span></td>                        </tr>"}),$("#select_mount_list").html(i),$("#select_dir_list").html(a),t&&t(e)})},data_reconstruction:function(e,t,i){if(e.length<1)return[];var a=[];return $.each(e,function(e,i){var s=i.split(";"),n="",l=s[0].split("."),c=l[l.length-1];switch(s[0]){case".user.ini":n="PS: PHP用户配置文件(防跨站)!";break;case".htaccess":n="PS: Apache用户配置文件(伪静态)";break;case"swap":n="PS: 宝塔默认设置的SWAP交换分区文件"}-1!=s[0].indexOf("Recycle_bin")&&(n="PS: 回收站目录,勿动!"),-1!=s[0].indexOf(".upload.tmp")&&(n="PS: 宝塔文件上传临时文件,重新上传从断点续传,可删除"),a.push({caret:"1"==s[8],down_id:s[9],ext:"DIR"==t?"":c,filename:s[0],mtime:s[2],ps:n||s[10],size:s[1],type:"DIR"==t?"dir":"file",user:s[3],root_level:s[4]})}),a},render_path_list:function(e){var t=this,i='<div class="file_dir_omit hide" title="展开已隐藏的目录"><span></span><i class="iconfont icon-zhixiang-zuo"></i><div class="nav_down_list"></div></div>',a="",s=this.file_path.split("/").splice(1),n=this.file_path.split("/")[0];"Windows"===bt.os?(0==s.length&&(s=[]),s.unshift('<span class="glyphicon glyphicon-hdd"></span><span class="ml5">本地磁盘('+n+")</span>")):("/"==this.file_path&&(s=[]),s.unshift("根目录"));for(var l=0;l<s.length;l++)a+="/"+s[l],0==l&&(a=""),i+='<div class="file_dir_item">\t\t\t\t\t\t\t\t<span class="file_dir" title="'+(n+a)+'">'+s[l]+'</span>\t\t\t\t\t\t\t\t<i class="iconfont icon-arrow-right"></i>\t\t\t\t\t\t\t\t<ul class="nav_down_list">\t\t\t\t\t\t\t\t\t<li data-path="*"><span>加载中</span></li>\t\t\t\t\t\t\t\t</ul>\t\t\t\t\t\t\t</div>';$(".path_input").val("").attr("data-path",this.file_path);var c=$(".file_path_input .file_dir_view");c.html(i),c.attr("data-width",c.width()),t.set_dir_view_resize()},set_select_width:function(e,t){var i=".select_dir_list tbody td:nth-child("+(e+1)+")>span,.select_dir_list thead th:nth-child("+(e+1)+")>span",a=$("#th-index-"+e);a.length>0?a.html(i+"{"+t+"}"):$("#select_file_style").append('<style type="text/css" id="th-index-'+e+'">'+i+"{"+t+"}</style>")},cut_style_object:function(e){var t={},i=e.split(";");return console.log(i),t},getScrollbarWidth:function(){var e,t,i=document.createElement("div"),a={width:"100px",height:"100px",overflowY:"scroll"};for(e in a)i.style[e]=a[e];return document.body.appendChild(i),t=i.offsetWidth-i.clientWidth,i.remove(),t},set_dir_view_resize:function(){var e=$(".file_path_input"),t=$(".file_path_input .file_dir_view"),i=t.attr("data-width"),a=null;if(i?parseInt(i):(i=t.width(),t.attr("data-width",i)),t.width()-i<90){var s=0;$($(".file_path_input .file_dir_view .file_dir_item").toArray().reverse()).each(function(){var t=0;$(this).attr("data-width")?t=parseInt($(this).attr("data-width")):($(this).attr("data-width",$(this).width()),t=$(this).width()),s+=t,e.width()-s<=90?$(this).addClass("hide"):$(this).removeClass("hide")})}a=t.children(".file_dir_item.hide").clone(!0);0==t.children(".file_dir_item.hide").length?e.removeClass("active").find(".file_dir_omit").addClass("hide"):(a.each(function(){0==$(this).find(".glyphicon-hdd").length&&$(this).find(".file_dir").before('<span class="file_dir_icon"></span>')}),e.addClass("active").find(".file_dir_omit").removeClass("hide"),e.find(".file_dir_omit .nav_down_list").empty().append(a),e.find(".file_dir_omit .nav_down_list .file_dir_item").removeClass("hide"))},reader_file_list:function(e,t){var i=this;if("function"==typeof e&&(t=e,e={is_operating:!1}),void 0===e&&(e={is_operating:!1}),a)return layer.msg("只能在该目录下操作",{icon:2}),!1;this.loadT=bt.load("正在获取文件列表,请稍候..."),this.file_images_list=[],i.get_dir_list(e,function(e){i.loadT.close(),i.file_list=$.merge(i.data_reconstruction(e.DIR,"DIR"),i.data_reconstruction(e.FILES)),i.file_path=e.PATH,i.is_recycle=e.FILE_RECYCLE,i.file_store_list=e.STORE,bt.set_cookie("Path",e.PATH);var a="",s="",n=e.DISK,l=i.file_list;i.select_list=i.file_list,i.render_path_list(),$.each(n,function(e,t){var i="/"==t.path?"根目录":t.path.indexOf(":/")>-1?"本地磁盘("+t.path.match(/[A-Z]+/)[0]+":)":t.path;a+='<div class="item" data-menu="'+t.path+'" title="名称:&nbsp;'+i+"\n路径:&nbsp;"+t.path+"\n总容量:&nbsp;"+t.size[0]+"\n可用容量:&nbsp;"+t.size[2]+'"><span class="glyphicon glyphicon-hdd mr5"></span><span>'+i+"</span></div>"}),$.each(l,function(e,t){if(0==i.type&&t.type!=i.type_limit)return!0;var a=bt.format_data(t.mtime),n="dir"==t.type?"文件夹":"文件";s+='<tr data-index="'+e+'" title="名称：'+t.filename+"\r修改时间:"+a+"\r类型："+n+'" data-path="'+t.filename+'" data-type="'+t.type+'">                            <td><span><i class="'+t.type+'-icon"></i><span>'+t.filename+"</span></span></td>                            <td><span>"+a+"</span></td>                            <td><span>"+("dir"==t.type?"文件夹":"文件")+"</span></td>                        </tr>"}),$("#select_mount_list").html(a),$("#select_dir_list").html(s);var c=e.PATH.lastIndexOf("/");e.PATH.substring(c+1,e.PATH.length);t&&t(rdata)})},reader_file_list_content:function(e,t){var i="",a=this,s=0;$.each(e,function(e,t){var n=t.filename+t.ps;a.file_list[e]=t=a.$file_data_dispose(t),a.file_list[e].only_index=e,t.filename.indexOf("Recycle_bin")&&(_tips="PS: 回收站目录,勿动!"),n.length>20&&(n=n.substring(0,20)+"..."),bt.check_chinese(n)&&n.length>10&&(n=n.substring(0,10)+"..."),i+='<div class="file_tr" data-index="'+e+'"><div class="file_td file_checkbox"><div class="file_check"></div></div><div class="file_td file_name"><div class="file_ico_type"><i class="file_icon '+("dir"==t.type?"file_folder":""==t.ext?"":"file_"+t.ext)+'"></i></div><span class="file_title file_'+t.type+'_status" title="'+a.file_path+"/"+t.filename+'"><i>'+t.filename+t.ps+"</i></span>"+(t.caret?'<span class="iconfont icon-favorites" style="'+(t.down_id?"right:30px":"")+'" title="文件已收藏，点击取消"></span>':"")+(t.down_id?'<span class="iconfont icon-share1" title="文件已分享，点击查看信息"></span>':"")+'</div><div class="file_td file_type"><span title="'+t.type_tips+'">'+t.type_tips+'</span></div><div class="file_td file_size"><span>'+("dir"==t.type?'<a class="btlink folder_size" href="javascript:;" data-path="'+a.file_path+"/"+t.filename+'">点击计算</a>':bt.format_size(t.size))+'</span></div><div class="file_td file_mtime"><span>'+bt.format_data(t.mtime)+"</span></div></div>","dir"==t.type&&s++,t.ispreview&&(a.file_images_list.push(t.path),t.images_id,t.images_id=a.file_images_list.length-1)}),$(".file_list_content").html(i),t&&t({is_dir_num:s})},$file_data_dispose:function(e){var t={languages:null,model:null};return $.extend(e,{only_id:bt.get_random(10),type_tips:"dir"===e.type?"文件夹":this.ext_type_tips(e.ext),open_type:this.determine_file_type(e.ext),languages:t.languages,path:e.path||this.path_resolve(this.file_path,e.filename),model:t.model})},path_resolve:function(e,t){var i="";return Array.isArray(t)||(t=[t]),e.replace(/([\/|\/]*)$/,function(e){return e,"www"}),$.each(t,function(e,t){i+="/"+t}),e+i},$get_file_model:function(e){var t=this.vscode_editor.config;for(languages in t.supportedModes)for(var i=t.supportedModes[languages],a=0;a<i[0].length;a++)if(console.log(e.ext,i[0][a]),e.ext===i[0][a])return{languages:languages,model:i[1]};return{languages:"text",model:"Text"}},render_file_disk_list:function(){var e=this,t="";e.get_disk_list(function(e){$.each(e,function(e,i){t+='<div class="nav_btn" data-menu="'+i.path+'"><span class="glyphicon glyphicon-hdd"></span><span>'+("/"==i.path?"根目录":i.path)+" ("+i.size[2]+")</span></div>"}),$(".mount_disk_list").html(t)})},determine_file_type:function(e,t){var i={images:["jpg","jpeg","png","bmp","gif","tiff","ico"],compress:["zip","rar","gz","war","tgz"],video:["mp4","mpeg","mpg","mov","avi","webm","mkv"],ont_text:["iso","xlsx","xsl","doc","docx","tiff","exe","so","7z","bz","dmg","apk"]},a=!1;if(null!=t)if("text"==t)$.each(i,function(t,i){$.each(i,function(t,i){if(i==e)return a=!0,!1})}),a=!a;else{if(void 0===i[t])return!1;$.each(i[t],function(t,i){if(i==e)return a=!0,!1})}else $.each(i,function(t,i){$.each(i,function(i,s){if(s==e)return a=t,!1})}),"boolean"==typeof a&&(a="text");return a},render_file_groud_menu:function(e,t){var i=this,a=$(t).data("index"),s=i.file_list[a],n=[["open","打开"],["split",""],["download","下载"],["share","分享目录/文件"],["cancel_share","取消分享"],["favorites","收藏目录/文件"],["cancel_favorites","取消收藏"],["split",""],["dir_kill","目录查杀"],["authority","权限"],["split",""],["copy","复制"],["shear","剪切"],["rename","重命名"],["del","删除"],["split",""],["killing","创建压缩",[["gzip","tar.gz (推荐)"],["zip","zip (通用格式)"],["rar","rar (中文兼容较好)"]]],["unzip","解压",[["local","解压到当前"],["folad","解压到当前"]]]],l=["zip","rar","gz","war","tgz","bz2"],c=0;"dir"==s.type&&(n.splice(2,1),c++),0!==s.down_id?(n.splice(3-c,1),c++):(n.splice(4-c,1),n[3-c][1]="dir"==s.type?"分享目录":"分享文件",c++),!1!==s.caret?(n.splice(5-c,1),c++):(n.splice(6-c,1),n[5-c][1]="dir"==s.type?"收藏目录":"收藏文件",c++),"php"!=s.ext&&"dir"!=s.type&&(n.splice(8-c,1),c++);var o=0;$.each(l,function(e,t){t==s.ext&&o++}),0==o&&(n.splice(17-c,1),c++),i.reader_menu_list({el:$(".selection_right_menu"),ev:e,data:s,list:n})},render_file_all_menu:function(e,t){var i=this,a=[["refresh","刷新"],["split",""],["upload","上传"],["create","新建文件夹/文件",[["create_dir","新建文件夹"],["create_files","新建文件"]]],["split",""],["paste","粘贴"]];bt.get_storage("session","copy_path")||a.splice(5,1),i.reader_menu_list({el:$(".selection_right_menu"),ev:e,data:{},list:a})},get_dir_list:function(e,t,i){var a=this;"boolean"==typeof t&&(i=t,t=null),s.$http("GetDir",$.extend({disk:!0,path:a.file_path,sort:bt.get_cookie("files_sort")||"type"},e),t,i)},retrun_prev_path:function(e){var t=e.split("/");return t.splice(t.length-1),t.join("/")},reader_menu_list:function(e){var t=this,i=e.el.find("ul"),a=i.height(),s=i.width(),n=e.ev.clientX-(this.area[0]-e.ev.clientX<s?s:0);i.empty(),$.each(e.list,function(a,s){var n=null,l=null;"split"==s[0]?i.append('<li class="separate"></li>'):(Array.isArray(s[2])&&(n=$('<div class="file_menu_down"><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span><ul class="set_group"></ul></div>'),l=n.find(".set_group"),$.each(s[2],function(i,a){l.append($('<li><i class="file_menu_icon '+a[0]+'_file_icon"></i><span>'+a[1]+"</span></li>").on("click",{type:a[0],data:e.data},function(i){t.file_groud_event($.extend(i.data.data,{open:i.data.type,index:parseInt($(e.ev.currentTarget).data("index")),element:e.ev.currentTarget,type_tips:s.type?"文件夹":"文件"})),e.el.removeAttr("style"),i.stopPropagation(),i.preventDefault()}))})),i.append($('<li><i class="file_menu_icon '+s[0]+"_file_icon "+function(e){switch(e){case"share":case"cancel_share":return"iconfont icon-share";case"dir_kill":return"iconfont icon-dir_kill";case"authority":return"iconfont icon-authority"}return""}(s[0])+'"></i><span>'+s[1]+"</span></li>").append(n).on("click",{type:s[0],data:e.data},function(i){t.file_groud_event($.extend(i.data.data,{open:i.data.type,index:parseInt($(e.ev.currentTarget).data("index")),element:e.ev.currentTarget,type_tips:s.type?"文件夹":"文件"})),e.el.removeAttr("style"),i.stopPropagation(),i.preventDefault()})))}),e.el.css({left:n,top:e.ev.clientY-(this.area[1]-e.ev.clientY<a?a:0)}).removeClass("left_menu right_menu").addClass(this.area[0]-(n+s)<230?"left_menu":"right_menu"),$(document).one("click",function(t){$(e.ev.currentTarget).removeClass("selected"),e.el.removeAttr("style"),t.stopPropagation(),t.preventDefault()})},ext_type_tips:function(e){var t={ai:"Adobe Illustrator格式图形",apk:"安卓安装包",asp:"动态网页文件",bat:"批处理文件",bin:"二进制文件",bas:"BASIC源文件",bak:"备份文件",css:"CSS样式表",cad:"备份文件",cxx:"C++源代码文件",crt:"认证文件",cpp:"C++代码文件",conf:"配置文件",dat:"数据文件",der:"认证文件",doc:"Microsoft Office Word 97-2003 文档",docx:"Microsoft Office Word 2007 文档",exe:"程序应用",gif:"图形文件",go:"Go语言源文件",htm:"超文本文档",html:"超文本文档",ico:"图形文件",java:"Java源文件",jsp:"HTML网页",jpe:"图形文件",jpeg:"图形文件",jpg:"图形文件",log:"日志文件",link:"快捷方式文件",js:"Javascript源文件",mdb:"Microsoft Access数据库",mp3:"音频文件",mp4:"视频文件",mng:"多映像网络图形",msi:"Windows Installe安装文件包",png:"图形文件",py:"Python源代码",pyc:"Python字节码文件",pdf:"文档格式文件",ppt:"Microsoft Powerpoint 97-2003 幻灯片演示文稿",pptx:"Microsoft Powerpoint2007 幻灯片演示文稿",psd:"Adobe photoshop位图文件",pl:"Perl脚本语言",rar:"RAR压缩文件",reg:"注册表文件",sys:"系统文件",sql:"数据库文件",sh:"Shell脚本文件",txt:"文本格式",vb:"Visual Basic的一种宏语言",xml:"扩展标记语言",xls:"Microsoft Office Excel 97-2003 工作表",xlsx:"Microsoft Office Excel 2007 工作表",gz:"压缩文件",zip:"ZIP压缩文件",z:"","7z":"7Z压缩文件",json:"JSON文本"};return void 0!==t[e]?t[e]:e+"文件"},event_bind:function(){var e=this;$("#select_dir_list").on("click","tr[data-index]",function(t){var i=$(this).data("index"),a=$(this).attr("data-type"),s="file"==e.type_limit&&"dir"==a?"":e.select_list[i].filename;$(this).addClass("active").siblings().removeClass("active"),$('[name="select_name"]').val(s),"file"==a?$(".file_path_views .forward_path span:eq(1)").addClass("active"):$(".file_path_views .forward_path span:eq(1)").removeClass("active")}),$(".select_list_body").on("scroll",function(e){var t=$(this).scrollTop(),i=$(this).scrollLeft();t>0?$(".select_list_shadow").show():$(".select_list_shadow").hide(),i>=0&&$(".select_list_thaed").css("left",4-i+"px"),e.stopPropagation(),e.preventDefault()}),$(".file_path_refresh").on("click",function(){e.render_file_list()}),$(".select_dir_list thead th .icon-drag").on("mousedown",function(t){var i=t.clientX,a=$(this).parent(),s=a.index(),n=a[0].clientWidth;parseInt($(this).parent().attr("data-min"));if(1===t.which){var l=function(t){var a=t.clientX,l=a-i,c=n+l;setTimeout(function(){e.set_select_width(s,"width:"+c+"px")},0)};$(document).on("mousemove",l).one("mouseup",function(){$(this).unbind(l),$(this).unbind(this)})}t.stopPropagation()}),$(".select_dir_list thead th>span").on("click",function(t){var i=$(this).parent(),a=i.data("type"),s=i.hasClass("active"),n=i.hasClass("sort");s?i.addClass("sort").removeClass("active"):n?i.addClass("active").removeClass("sort"):i.addClass("active"),i.siblings().removeClass("active sort"),e.render_file_list({sort:a,reverse:s?1:0}),t.stopPropagation()}),$(".search_path_views input").on("keyup",function(){var e=$(this).val();console.log(e)}),$(".search_path_views input").focus(function(){$(this).next().show()}).blur(function(){$(this).next().hide()}),$("#select_file_directory .select_file_group").on("click",".select_btn_group .btn-success",function(t){var i=$('[name="select_name"]').val(),a="";""==i?layer.msg("只能选择"+e.type_tips,{icon:2}):(a=e.file_path+"/"+i,console.log(a))}),$("#select_file_directory .select_file_tootls").on("click",".creat_dir",function(t){var i="<tr><td colspan='2'><span class='glyphicon glyphicon-folder-open'></span> <input id='newFolderName' class='newFolderName' type='text' value=''></td><td colspan='3'><button id='nameOk' type='button' class='btn btn-success btn-sm'>"+lan.public.ok+"</button>&nbsp;&nbsp;<button id='nameNOk' type='button' class='btn btn-default btn-sm'>"+lan.public.cancel+"</button></td></tr>";0==$("#tbody tr").length?$("#select_dir_list").append(i):$("#select_dir_list tr:first-child").before(i),$(".newFolderName").focus(),$("#nameOk").click(function(){var t=$("#newFolderName").val(),i=$(".file_path_views .path_input").attr("data-path");newTxt=i+"/"+t,s.$http("CreateDir",{path:newTxt},function(t){1==t.status?(e.reader_file_list({path:i,is_operating:!1}),layer.msg(t.msg,{icon:1})):layer.msg(t.msg,{icon:2})})})}),$("#select_mount_list").on("click",".item",function(){e.reader_file_list({path:$(this).attr("data-menu"),is_operating:!0})}),$(window).resize(function(t){$(this)[0].innerHeight!=e.area[1]&&(e.area[1]=$(this)[0].innerHeight,e.set_file_view()),
$(this)[0].innerWidth!=e.area[0]&&(e.area[0]=$(this)[0].innerWidth,e.set_dir_view_resize()),e.vscode_editor.view&&e.vscode_editor.is_full_min>0&&layer.style(e.vscode_editor.view,{top:0,left:0,width:e.area[0],height:e.area[1]}),e.vscode_editor.view&&$.isEmptyObject(e.vscode_editor.list)&&e.vscode.layout()}).keydown(function(t){t=window.event||t;var i=t.keyCode,a=t.target.tagName.toLowerCase();if(8==i&&"input"!==a&&"textarea"!==a)return null==e.vscode_editor.view&&$(".forward_path span:eq(0)").click(),!1}),$(".file_path_input .path_input").on("focus blur keyup",function(t){t=t||window.event;var i=$(this).attr("data-path");switch(t.type){case"focus":$(this).addClass("focus").val(i).prev().hide();break;case"blur":$(this).removeClass("focus").val("").prev().show();break;case"keyup":if(13!=t.keyCode&&"keyup"==t.type)return!1;var a=$(this);$(this).data("path")!=$(this).val()&&e.reader_file_list({path:$(this).val(),is_operating:!0},function(e){!1===e.status?$(a).val(i):($(a).val(e.PATH),$(a).blur().prev().show())})}t.stopPropagation()}),$(".file_path_input .file_dir_view").on("click",".file_dir",function(){e.reader_file_list({path:$(this).attr("title"),is_operating:!0})}),$(".forward_path span").click(function(){var t=$(this).index(),i="";if(!$(this).hasClass("active")){switch(t){case 0:e.file_pointer=e.file_pointer-1,i=e.retrun_prev_path(e.file_path);break;case 1:e.file_pointer=e.file_pointer+1,i=e.file_path+"/"+$(".select_file_group .file_directory").val();break;case 2:e.file_pointer=e.file_pointer-1,i=e.retrun_prev_path(e.file_path)}e.reader_file_list({path:i,is_operating:!1})}}),$(".file_path_input .file_dir_view").on("click",".file_dir_omit",function(e){var t=this,i=$(this).children(".nav_down_list");$(this).addClass("active"),i.addClass("show"),$(document).one("click",function(){$(t).removeClass("active"),i.removeClass("show"),e.stopPropagation()}),e.stopPropagation()}),$("#select_dir_list").on("dblclick","tr",function(t){if($(t.target).hasClass("file_check"))return!1;var i=$(this).attr("data-path"),a=$(this).attr("data-type");"dir"==a&&e.reader_file_list({path:e.file_path+"/"+i}),t.stopPropagation(),t.preventDefault()}),$(".file_path_refresh").click(function(){e.reader_file_list({path:e.file_path})}),$(".file_nav_view .upload_or_download").on("click",function(t){e.open_upload_view(),t.stopPropagation(),t.preventDefault()}),$(".file_nav_view .upload_or_download li").on("click",function(t){var i=$(this).data("type");"uploadFile"===i?e.open_upload_view():e.open_download_view(),t.stopPropagation(),t.preventDefault()}),$(".mount_disk_list").on("click",".nav_btn",function(){var t=$(this).data("menu");e.reader_file_list({path:t})}),$(".file_list_header").on("click",".file_name,.file_size,.file_mtime,.file_accept,.file_user",function(t){var i=$(this).attr("data-tid"),a=$(this).find(".icon_sort").hasClass("active"),s=$(this).hasClass("active");return!$(this).find(".icon_sort").hasClass("active")&&$(this).hasClass("active")?$(this).find(".icon_sort").addClass("active"):$(this).find(".icon_sort").removeClass("active"),$(this).addClass("active").siblings().removeClass("active").find(".icon_sort").removeClass("active").empty(),$(this).find(".icon_sort").html('<i class="iconfont icon-xiala"></i>'),s||(a=!0),bt.set_cookie("files_sort",i),bt.set_cookie("name_reverse",a?1:0),e.reader_file_list(),!1}),$(".file_list_header .file_th").each(function(e,t){var i=bt.get_cookie("files_sort"),a=bt.get_cookie("name_reverse");$(this).attr("data-tid")===i&&($(this).addClass("active").siblings().removeClass("active").find(".icon_sort").removeClass("active").empty(),$(this).find(".icon_sort").html('<i class="iconfont icon-xiala"></i>'),0===a&&$(this).find(".icon_sort").addClass("active"))}),$(".file_list_header .file_check").on("click",function(t){var i=parseInt($(this).data("checkbox"));switch(i){case 0:$(this).addClass("active").removeClass("active_2").data("checkbox",1),$(".file_list_content .file_tr").addClass("active").removeClass("active_2"),e.file_table_arry=e.file_list;break;case 2:$(this).addClass("active").removeClass("active_2").data("checkbox",1),$(".file_list_content .file_tr").addClass("active"),e.file_table_arry=e.file_list;break;case 1:$(this).removeClass("active active_2").data("checkbox",0),$(".file_list_content .file_tr").removeClass("active"),e.file_table_arry=[]}}),$(".file_list_content").on("click",".file_check",function(t){var i=$(this).parents(".file_tr"),a=i.data("index"),s=$(".file_list_header .file_check"),n=i.attr("data-filename");$(".selection_right_menu").removeAttr("style"),i.hasClass("active")?(i.removeClass("active"),e.remove_check_file(e.file_table_arry,"filename",n),e.file_table_arry.length>0?s.addClass("active_2").removeClass("active").data("checkbox",2):0==e.file_table_arry.length&&s.removeClass("active active_2").data("checkbox",0)):(i.addClass("active"),i.attr("data-filename",e.file_list[a].filename),e.file_table_arry.length==e.file_list.length?s.addClass("active").removeClass("active_2").data("checkbox",1):s.addClass("active_2").removeClass("active").data("checkbox",2),e.file_table_arry.push(e.file_list[a])),t.stopPropagation()}),$(".file_list_content").scroll(function(e){$(this).scrollTop()==$(this)[0].scrollHeight-$(this)[0].clientHeight?($(this).prev().css("opacity",1),$(this).next().css("opacity",0)):$(this).scrollTop()>0?$(this).prev().css("opacity",1):0==$(this).scrollTop()&&($(this).prev().css("opacity",0),$(this).next().css("opacity",1))}),$(".file_table_view .file_list_content").on("click",".file_tr",function(e){$(".selection_right_menu").removeAttr("style"),$(this).find(".file_checkbox .file_check").click(),e.stopPropagation(),e.preventDefault()}),$(".file_table_view .file_list_content").on("click",".file_title i",function(t){var i=$(this).parents(".file_tr"),a=i.data("index"),s=e.file_list[a];"dir"==s.type&&e.reader_file_list({path:e.file_path+"/"+s.filename}),t.stopPropagation()}),$(".file_table_view .file_list_content").on("click",".file_name .icon-share1",function(t){var i=$(this).parents(".file_tr"),a=i.data("index"),s=e.file_list[a];e.info_file_share(s,i),t.stopPropagation()}),$(".file_table_view .file_list_content").on("click",".file_name .icon-favorites",function(t){var i=$(this).parents(".file_tr"),a=i.data("index"),s=e.file_list[a];s.typeText=s.type?"文件夹":"文件",e.cancel_file_favorites(s,i),t.stopPropagation()}),$(".file_table_view .file_list_content").on("dblclick",".file_tr",function(t){if($(t.target).hasClass("file_check"))return!1;var i=$(this).data("index"),a=e.file_list[i];"dir"==a.type&&e.reader_file_list({path:e.file_path+"/"+a.filename}),t.stopPropagation(),t.preventDefault()}),$(".file_list_content").on("contextmenu",".file_tr",function(t){var i=this;3==t.which&&(e.render_file_groud_menu(t,this),$(".content_right_menu").removeAttr("style"),$(this).addClass("selected").siblings().removeClass("selected"),$(document).one("click",function(e){$(i).removeClass("selected"),$(".selection_right_menu").removeAttr("style"),e.stopPropagation(),e.preventDefault()})),t.stopPropagation(),t.preventDefault()}),$(".file_list_content").on("contextmenu",function(t){var i=$(".content_right_menu");i.width(),i.height();3==t.which&&($(".selection_right_menu").removeAttr("style"),e.render_file_all_menu(t,this)),t.stopPropagation(),t.preventDefault()}),$(".filePage").on("change",".showRow",function(){var t=$(this).val();bt.set_storage("showRow",t),e.reader_file_list()}),$(".file_list_content").on("click",".folder_size",function(e){var t=i.file_list[$(this).parents(".file_tr").data("index")],i=this;i.get_file_size({path:t.path},function(e){$(i).text(bt.format_size(e.size))}),e.stopPropagation(),e.preventDefault()}),$(".cut_view_model").on("click",function(){var e=$(this).data("type");$(".file_table_view").addClass("icon"==e?"icon_view":"list_view").removeClass("icon"!=e?"icon_view":"list_view"),$(this).addClass("active").siblings().removeClass("active")})},set_file_forward:function(){var e=this,t=$(".forward_path span");console.log(e.file_operation),1==e.file_operating.length?t.addClass("active"):e.file_pointer==e.file_operating.length-1?(t.eq(0).removeClass("active"),t.eq(1).addClass("active")):0==e.file_pointer?(t.eq(0).addClass("active"),t.eq(1).removeClass("active")):t.removeClass("active")},set_file_view:function(){var e=$(".file_list_content"),t=this.area[1]-170;$(".file_bodys").height(this.area[1]-100),50*this.file_list.length>t?(e.attr("data-height",e.data("height")||e.height()).height(t),$(".file_shadow_bottom").css("opacity",1)):(e.height(t),$(".file_shadow_top,.file_shadow_bottom").css("opacity",0))},clear_table_active:function(){this.file_table_arry=[],$(".file_list_header .file_check").removeClass("active active_2"),$(".file_list_content .file_tr").removeClass("active")}};n.reader_view(),n.event_bind()},send:function(e,t,i,a,s,n){function l(e){try{o="function"==d[e][1]?d[e][0]:null,r="function"==d[e+1][1]?d[e+1][0]:null}catch(e){}}var c={},o=null,r=null,d=[],p="";switch($.each(arguments,function(e,t){d.push([t,typeof t])}),p=d[0],p[1]){case"string":$.each(d,function(e,t){var i=t[0],a=t[1];if(e>1&&("boolean"==a||"string"==a||"object"==a)){var s=p[0].split("/");return c.url="/"+s[0]+"?action="+s[1],c.load=i,"object"==a&&(c.load=i.load,c.tips=i.tips,c.verify=i.verify),!1}c.url=p[0]}),"object"===d[1][1]?(c.data=d[1][0],l(2)):l(1);break;case"object":c.url=p[0].url,c.data=p[0].data||{},$.each(d,function(e,t){var i=t[0],a=t[1];if(e>1&&("boolean"==a||"string"==a||"object"==a))return c.load=t,"object"==a&&(c.load=i.load,c.tips=i.tips),!0}),"object"===d[1][1]?(c.data=d[1][0],l(2)):l(1)}c.load&&(c.load=this.load(c.load)),$.ajax({type:c.type||"POST",url:c.url,data:c.data||{},dataType:c.dataType||"JSON",complete:function(){c.load&&c.load.close()},success:function(e){return c.verify?(o&&o(e),!1):"string"==typeof e?(layer.msg(e,{icon:2,time:0,closeBtn:2}),!1):c.bacth?(o&&o(e),!1):!1===e.status?(bt_tools.msg(e),!1):(c.tips&&bt_tools.msg(e),void(o&&o(e)))},error:function(e){r&&r(e),layer.closeAll("dialog"),layer.closeAll("loading"),layer.msg("Service response error："+e.status+"</br>error msg："+e.statusText+"</br>URL："+c.url+"</br>param："+JSON.stringify(c.data),{icon:2,time:0,closeBtn:2})}})}};$.fn.serializeObject=function(){var e=Object.prototype.hasOwnProperty;return this.serializeArray().reduce(function(t,i){return e.call(t,i.name)||(t[i.name]=i.value),t},{})};